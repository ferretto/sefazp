require "spec_helper"

describe Sefazp do
  let(:cte_xml_content) { File.open("spec/fixtures/cte.xml", "r") }

  it "should parse a cte" do
    expect(Sefazp.parse_cte(cte_xml_content)).to eq({ :municipio_do_emitente=>"3556701", :municipio_do_remetente=>"3106200", :municipio_do_destinatario=>"3529401", :municipio_de_origem=>"3106200", :municipio_de_destino=>"3529401", :municipio_de_emissao=>"3505708", :numero=>"15424", :serie=>"2", :chave_de_acesso=>"CTe35150110663500000167570020000154241000000014", :tipo_do_cte=>"0", :tipo_do_servico=>"0", :tomador_do_servico=>"0", :forma_de_pagamento=>"0", :codigo_do_cfop=>"6353", :descricao_do_cfop=>"ESTABELECIMENTO COMERCIAL", :cnpj_do_emitente=>"10663500000167", :inscricao_estadual_do_emitente=>"714107634116", :nome_do_emitente=>"ARELLANO VOSS TRANSPORTES LTDA.", :nome_fantasia_do_emitente=>"AVT - BARUERI - DAY BRASIL 1", :logradouro_do_emitente=>"RUA SANTA CRUZ", :numero_do_emitente=>"481", :bairro_do_emitente=>"BARRA FUNDA", :cep_do_emitente=>"13280000", :cnpj_do_remetente=>"49327943000384", :inscricao_estadual_do_remetente=>"0623502100062", :nome_do_remetente=>"DAY BRASIL S/A", :logradouro_do_remetente=>"R CALDAS DA RAINHA", :numero_do_remetente=>"1359", :bairro_do_remetente=>"SAO FRANCISCO", :cep_do_remetente=>"31255180", :cnpj_do_destinatario=>"00023779000160", :inscricao_estadual_do_destinatario=>"442195903117", :nome_do_destinatario=>"POLYSISTEM IMP E EXP DE POLICARBONATO LT", :logradouro_do_destinatario=>"RUA RINALDO CHIAROTTI", :numero_do_destinatario=>"491", :bairro_do_destinatario=>"SERTAOZINHO", :cep_do_destinatario=>"09372060", :produto_predominante=>"VARIOS", :unidade_de_medida=>"PECAS", :quantidade=>"225", :valor_da_mercadoria=>"45677.25", :responsavel=>"0", :valor_total=>"370.68", :valor_a_receber=>"370.68", :base_de_calculo=>"370.68", :aliquota_icms=>"12.00", :valor_icms=>"44.48", :lotacao=>"1", :data_prevista_de_entrega=>"2015-01-21", :tipo_do_veiculo=>"0", :placa_do_veiculo=>"EWJ1042", :uf_do_veiculo=>"SP", :renavan_do_veiculo=>"00547274670", :tara_em_kg_do_veiculo=>"15750", :capacidade_em_kg_do_veiculo=>"0", :capacidade_em_m3_do_veiculo=>"0", :nome_do_motorista=>"CELIO OLIVEIRA SANTOS", :cpf_do_motorista=>"12403654892", :rntrc=>"46072566", :frete=>"370.68", :pedagio=>"0.00", :outros=>"0.00", :nfe_keys=>["31150149327943000384550010000318811007008823"] })
  end

end
